\begingroup
\makeatletter
\renewenvironment{recipe}[2][]
{% initialisation
    \setkeys{recipe}{preparationtime, bakingtime, bakingtemperature, portion, calory, source}
    \setkeys{picture}{small, big, smallpicturewidth=\xcb@smallpicturewidth, bigpicturewidth=\xcb@bigpicturewidth} % load the default values
    \def\xcb@hook@pregraph{}
    \def\xcb@hook@pretitle{}
    \def\xcb@introduction{}
    \def\xcb@hook@prepreparation{}
    \preparation{}
    \def\xcb@hook@postpreparation{}
    \def\xcb@hook@preingredients{}
    \ingredients{}
    \def\xcb@hook@postingredients{}
    \def\xcb@suggestion{}
    \def\xcb@hint{}

    \def\xcb@recipename{#2}
    \setkeys{recipe}{#1}  % reading the optional parameters

    \setcounter{xcb@newpagefoot}{1}
    \setcounter{xcb@newpagehead}{\value{page}}
}
{% this part is executed at \end{recipe}
%% FIRST BLOCK
    \xcb@hook@pregraph
    \if@twoside
        \ifodd\arabic{page}
            \begin{minipage}[T]{\xcb@picture@bigwidth}
                \xcb@picture@big
            \end{minipage}
            \hfill
            \begin{minipage}[T]{\xcb@picture@smallwidth}
                \xcb@picture@small
            \end{minipage}
        \else
            \begin{minipage}[T]{\xcb@picture@smallwidth}
                \xcb@picture@small
            \end{minipage}
            \hfill
            \begin{minipage}[T]{\xcb@picture@bigwidth}
                \xcb@picture@big
            \end{minipage}
        \fi
    \else
        \begin{minipage}[T]{\xcb@picture@bigwidth}
            \xcb@picture@big
        \end{minipage}
        \hfill
        \begin{minipage}[T]{\xcb@picture@smallwidth}
            \xcb@picture@small
        \end{minipage}
    \fi

%% SECOND BLOCK
    \xcb@hook@pretitle
    \recipesection[\normalsize\xcb@recipename]%
    {\hspace{-1em}\textcolor{\xcb@color@recipename}{\xcb@font@recipename\xcb@recipename}}
    \xcb@cmd@recipeoverview

    \xcb@introduction

%% THIRD BLOCK
    \columnratio{0.66}
    \begin{paracol}{2}
        \xcb@hook@prepreparation

        \xcb@preparation

        \xcb@hook@postpreparation

        \xcb@suggestion

        \vfill

        \xcb@cmd@wrapfill
        \xcb@hint
        \setcounter{xcb@newpagefoot}{0}
      \switchcolumn
            \xcb@hook@preingredients

            \xcb@ingredients

            \xcb@hook@postingredients
    \end{paracol}
}

\renewcommand*{\ingredients}[2][\empty]
{% The optional argument contains the number of lines
    \def\xcb@ingredientslines{#1}
    \def\xcb@ingredients
    {%
        \xcb@name@inghead
        \\[1em]
        {\xcb@fontsize@ing\color{\xcb@color@ing}
        \begin{supertabular}{r>{\raggedright\arraybackslash}p{3cm}}
            #2
        \end{supertabular}}
    }
}
\makeatother

\begin{recipe}
    [
        preparationtime = {\SI{30}{\minute}},
        bakingtime = {\SI{30}{\minute}},
        bakingtemperature = {\protect\bakingtemperature{topbottomheat=\SI{200}{\degree}}},
        portion = {6 Portionen},
        source = {Michaela Vais}
    ]
    {\addtoidx{Linsen} \addtoidx{Moussaka}}

    \graph
        {
            small=Hauptgerichte/Auflaeufe/Linsen_Moussaka/small.jpg,
            big=Hauptgerichte/Auflaeufe/Linsen_Moussaka/big.jpg
        }

    \introduction{Leckere Linsen Moussaka mit Auberginen und Kartoffeln. Dieses beliebte griechische Gericht kann leicht ohne Fleisch zubereitet werden und schmeckt trotzdem super. Das Rezept ist vegan, glutenfrei und relativ leicht herzustellen.}

    \ingredients{
        \SI{1}{\kg} & \addtoidx{Kartoffeln} \\
        3 & große \addtoidx{Auberginen} \\
         & Olivenöl \\
         & Meersalz \\
         & Pfeffer \\
        \\
        \multicolumn{2}{l}{\textbf{Linsenmischung}}\\
        \SI{600}{\g} & gekochte Linsen \\
        \SI{450}{\g} & passierte Tomaten \\
        \SI{150}{\g} & gehackte Tomaten \\
        \SI{1}{\EL} & Olivenöl \\
        1 & große Zwiebel \\
        2 & Knoblauchzehen \\
        2 & Lorbeerblätter \\
        \SI{1}{\TL} & Thymian \\
        \SI{1}{\TL} & Oregano \\
        \SI{1}{\TL} & Paprika \\
        \SI{1}{\TL} & brauner Zucker \\
        \SI{1}{Prise} & Zimt \\
        & Meersalz \\
        & Pfeffer \\
        \\
        \multicolumn{2}{l}{\textbf{Béchamelsoße}}\\
        \SI{30}{\g} & vegane Butter \\
        \SI{480}{\ml} & pflanzl. Milch \\
        \SI{30}{\g} & Maisstärke \\
        \SI{2}{\EL} & Hefeflocken \\
        & Meersalz \\
        & Pfeffer \\
        1 Prise & Muskatnuss \\
        & optional: Veganer Käse \\
    }

    \preparation{
        \step Den Ofen auf \SI{200}{\degree} vorheizen und zwei Backbleche mit Backpapier auslegen. Jede Aubergine der Länge nach in vier Stücke schneiden. Die Kartoffel in 1 cm dicke Scheiben schneiden. Alle Scheiben in einer Schicht auf dem Backblech anordnen und leicht mit etwas Olivenöl bepinseln, mit Salz und Pfeffer bestreuen. Im Ofen etwa \SI{20}{\minute} backen.

        \step In der Zwischenzeit \SI{1}{\EL} Olivenöl in einer Pfanne erhitzen. Zwiebel und Knoblauch für \ca \SI{4}{\minute} bis \SI{5}{\minute} anbraten. Tomatenpüree, gehackte Tomaten, alle Gewürze sowie Salz und Pfeffer dazugeben. Zum Schluss die gekochten Linsen hinzufügen und bei schwacher Hitze \ca \SI{5}{\minute} köcheln lassen.

        \step Für die Béchamelsoße die pflanzliche Milch in eine Pfanne geben. Die Maisstärke, Hefeflocken, Salz und Pfeffer dazugeben und verrühren. Die vegane Butter hinzugeben und die Mischung zum Kochen bringen. Bei geringer Hitze einige Minuten köcheln lassen, bis die Sauce andickt. Dabei immer wieder umrühren. Herdplatte ausmachen.

        \step Eine \SI{33}{\cm} mal \SI{23}{\cm} oder größere Backform einfetten und die Hälfte der Kartoffel- und Auberginenscheiben auf dem Boden der Backform verteilen. Die Linsen Mischung darüber geben, gefolgt von den restlichen Kartoffel- und Auberginenscheiben. Die Béchamelsoße darüber gießen und gleichmäßig verteilen. Veganen Käse nach Geschmack oben drauf verteilen.

        \step Im Ofen \ca \SI{30}{\minute} backen oder bis die Béchamelschicht goldbraun ist. Mit frischen Kräutern garnieren.
    }

    % \suggestion[]{
    %
    % }

    \hint{Als oberste Schicht lässt sich gut Kartoffelpüree verwenden, wenn die Béchamelsoße ersetzt werden soll. Dann wird der Auflauf zum Shepherd's Pie.}

\end{recipe}
\endgroup
